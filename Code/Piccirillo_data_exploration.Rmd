---
title: "Piccirillo_data_exploration"
author: "Laura Piccirillo"
date: "2025-12-01"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# Install and load your packages
#install.packages("tidyverse")
#install.packages("here")
#install.packages("ggplot2")
#install.packages("lubridate")
library(tidyverse)
library(here)
library(ggplot2)
library(lubridate)

# Set your working directory
setwd("~/ENV 872/Final Project/Piccirillo_ENV872_EDA_FinalProject")
getwd()
here()

# Set your ggplot theme
mytheme <- theme_bw() + theme(axis.text = element_text(color = "black"),
                              legend.position = "top",
                              legend.text = element_text(color = "black"))
theme_set(mytheme)

# Load your datasets
selenium_conc <- read.csv(here(
  "Data/Raw/As_Se_IO_BOTTLE.csv"), 
                          stringsAsFactors = T)
oxygen <- read.csv(
  here(
  "Data/Raw/GT-C_SBE_CTD_Proc_v30Oct2014.csv"),
  stringsAsFactors = T)
```


```{r, investigate datasets}
# explore datasets
dim(selenium_conc)
dim(oxygen)

glimpse(selenium_conc)
glimpse(oxygen)

# check class of selenium concentrations for each species and depth
class(selenium_conc$Se_IV_D_CONC_BOTTLE)
class(selenium_conc$Se_VI_D)
class(selenium_conc$Org_Se_II_CONC_BOTTLE)
class(selenium_conc$depth)

# changing missing values indicated by "nd" to NAs
selenium_conc$Se_IV_D_CONC_BOTTLE <- na_if(
  selenium_conc$Se_IV_D_CONC_BOTTLE, "nd")
sum(is.na(selenium_conc$Se_IV_D_CONC_BOTTLE))
nrow(selenium_conc)
selenium_conc$Se_IV_D_CONC_BOTTLE <- as.numeric(as.character(
  selenium_conc$Se_IV_D_CONC_BOTTLE))


#left off here - change nd values for other species

drop_na(selenium_conc$Se_IV_D_CONC_BOTTLE)


# look at distribution of values for total Se and each species
summary(selenium_conc$Se_TD_CONC_BOTTLE)
summary(selenium_conc$Se_IV_D_CONC_BOTTLE)
summary(selenium_conc$Se_VI_D)
summary(selenium_conc$Org_Se_II_CONC_BOTTLE)

# check class of oxygen values
class(oxygen$Sbeox0)
class(oxygen$DepSM)

# look at distribution of oxygen values
summary(oxygen$Sbeox0)
# will remove oxygen values below 0 in data processing step
```


```{r}
ggplot(selenium_conc, aes(Se_IV_D_CONC_BOTTLE, depth)) + geom_point() +
  scale_y_reverse() + labs(y = "Depth (m)", x = "SeIV Concentration (nm/L)") + 
  theme(axis.text.x = element_text(angle = 90)) + geom_smooth()

ggplot(selenium_conc, aes(Se_VI_D, depth)) + geom_violin() +
  scale_y_reverse() + labs(y = "Depth (m)", x = "SeVI Concentration (nm/L)") + 
  theme(axis.text.x = element_text(angle = 90))

ggplot(selenium_conc, aes(Org_Se_II_CONC_BOTTLE, depth)) + geom_boxplot() +
  scale_y_reverse() + labs(y = "Depth (m)", x = "Se2- Concentration (nm/L)")

```



```{r, look at locations of casts}
#convert data file into shapefile for spatial exploration
gage_sf <- gage_locations %>%
  st_as_sf(coords = c('dec_long_va','dec_lat_va'), crs=4269)
```

